<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì½”í¬ë‹ˆì§ ì²´ë ¥ì¸¡ì • ê²°ê³¼ì§€</title>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    body { font-family: 'Pretendard', sans-serif; background: #E0F2FE; padding: 1rem; }
    .glass-card { background: rgba(255,255,255,0.6); backdrop-filter: blur(12px); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.5); border-radius: 1rem; padding: 1.5rem; margin-bottom: 1.5rem; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 0.5rem; table-layout: fixed; }
    th, td { padding: 0.5rem; text-align: left; font-size: 0.875rem; word-break: keep-all; }
    th { background: #EFF6FF; color: #1E40AF; width: 40%; }
    td { background: #FFFFFF; width: 60%; }
    .title-gradient { background: linear-gradient(90deg, #3b82f6, #10b981); -webkit-background-clip: text; color: transparent; font-weight: 800; font-size: 1.875rem; text-align: center; margin-bottom: 2rem; }
    .score-bar { position: relative; width: 100%; height: 2rem; background: #f3f4f6; border-radius: 9999px; overflow: visible; margin-top: 1.5rem; }
    .score-seg { position: absolute; top: 0; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 0.625rem; font-weight: 500; color: white; }
    .threshold-label { position: absolute; top: -1.5rem; font-size: 0.75rem; font-weight: 600; color: #9ca3af; transform: translateX(-50%); }
    .marker-line { position: absolute; bottom: 0; height: 100%; width: 2px; background: #1f1f1f; transform: translateX(-50%); }
    .marker-arrow { position: absolute; bottom: -0.5rem; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 7px solid #1f1f1f; transform: translateX(-50%); }
    .marker-value { position: absolute; bottom: -2rem; font-size: 0.875rem; font-weight: 700; transform: translateX(-50%); color: #1f1f1f; }
    .tab-button { padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 600; border: 1px solid #3b82f6; border-radius: 9999px; background-color: white; color: #3b82f6; transition: 0.2s; }
    .tab-button:hover { background-color: #3b82f6; color: white; }
    .active-tab { background-color: #3b82f6; color: white; }
  </style>
</head>
<body>

<h1 class="title-gradient flex items-center justify-center gap-2">
  ì½”í¬ë‹ˆì§ ì²´ë ¥ì¸¡ì • ê²°ê³¼ì§€
  <div class="flex space-x-2">
    <button onclick="setMobileView()" class="tab-button text-xs">ğŸ“±</button>
    <button onclick="setDesktopView()" class="tab-button text-xs">ğŸ–¥ï¸</button>
  </div>
</h1>

<div id="mainContent" class="max-w-screen-lg mx-auto">
  <div class="flex flex-col md:flex-row md:space-x-4">
    <!-- ì¢Œì¸¡ : ê¸°ë³¸ì •ë³´, ì‹ ì²´ì¡°ì„± -->
    <div class="md:w-1/2 space-y-6">
      <div class="glass-card">
        <h2 class="text-lg font-bold text-indigo-700 mb-4">ê¸°ë³¸ ì •ë³´</h2>
        <table>
          <tbody>
            <tr><th>ì´ë¦„</th><td id="nameCell">-</td></tr>
            <tr><th>ì„±ë³„</th><td id="genderCell">-</td></tr>
            <tr><th>ìƒë…„ì›”ì¼</th><td id="birthCell">-</td></tr>
            <tr><th>ì¸¡ì •ì¼</th><td id="measureDateCell">-</td></tr>
          </tbody>
        </table>
      </div>

      <div class="glass-card">
        <h2 class="text-lg font-bold text-indigo-700 mb-4">ì‹ ì²´ì¡°ì„± í‰ê°€</h2>
        <table>
          <tbody>
            <tr><th>ì‹ ì¥ (cm)</th><td id="heightCell">-</td></tr>
            <tr><th>ì²´ì¤‘ (kg)</th><td id="weightCell">-</td></tr>
          </tbody>
        </table>
        <div id="growthInfo" class="text-xs text-right text-gray-500 mt-1">-</div>
        <h3 class="text-md font-semibold text-indigo-600 mt-6 mb-2">BMI í‰ê°€</h3>
        <div class="score-bar relative">
          <div class="score-seg bg-blue-400" style="left:0; width:25%;">ì €ì²´ì¤‘</div>
          <div class="score-seg bg-green-400" style="left:25%; width:20%;">ì •ìƒ</div>
          <div class="score-seg bg-yellow-400" style="left:45%; width:20%;">ê³¼ì²´ì¤‘</div>
          <div class="score-seg bg-orange-400" style="left:65%; width:35%; border-top-right-radius:9999px; border-bottom-right-radius:9999px;">ë¹„ë§Œ</div>
          <span class="threshold-label" style="left:25%;">18.5</span>
          <span class="threshold-label" style="left:45%;">23</span>
          <span class="threshold-label" style="left:65%;">25</span>
          <div id="bmiMarkerLine" class="marker-line"></div>
          <div id="bmiMarkerArrow" class="marker-arrow"></div>
          <span id="bmiMarkerValue" class="marker-value">-</span>
        </div>
      </div>
    </div>

    <!-- ìš°ì¸¡ : ì²´ë ¥ ì¢…í•© -->
    <div class="md:w-1/2">
      <div class="glass-card">
        <h2 class="text-lg font-bold text-indigo-700 mb-4">ì²´ë ¥ ì¸¡ì • ì¢…í•©</h2>
        <canvas id="radarChart" width="300" height="300"></canvas>
      </div>
    </div>
  </div>

  <h2 class="text-2xl font-bold text-indigo-700 mt-10 mb-4">í•­ëª©ë³„ ì„¸ë¶€ í‰ê°€</h2>
  <div id="detailCards" class="space-y-6"></div>

  <div class="flex justify-center gap-4 my-8">
    <button onclick="openReferenceModal()" class="tab-button">ì°¸ê³  ê¸°ì¤€ ë³´ê¸°</button>
    <button onclick="downloadPDF()" class="tab-button">PDF ì €ì¥í•˜ê¸°</button>
  </div>

  <div class="text-center text-sm text-gray-600 mt-10 mb-4">
    ìƒë‹´ë¬¸ì˜ : 010-5380-5840<br>
    <a href="https://linktr.ee/Kokenigym" target="_blank" class="text-blue-600 underline">ì½”í¬ë‹ˆì§ Linktree ë°”ë¡œê°€ê¸°</a>
  </div>
</div>
<!-- ì¸¡ì • ë°©ë²• ëª¨ë‹¬ -->
<div id="methodModal" class="hidden fixed inset-0 w-full h-full flex items-center justify-center bg-black bg-opacity-40 z-50">
  <div class="bg-white rounded-lg p-6 w-11/12 max-w-md shadow-lg">
    <h3 id="methodTitle" class="text-lg font-bold mb-4 text-center text-indigo-700"></h3>
    <p id="methodDesc" class="text-sm text-gray-700 mb-4 text-center"></p>
    <div class="text-center">
      <button onclick="closeMethodModal()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-1 px-4 rounded-full text-sm">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<!-- ë©˜íŠ¸ ìˆ˜ì • ëª¨ë‹¬ -->
<div id="editCommentModal" class="hidden fixed inset-0 w-full h-full flex items-center justify-center bg-black bg-opacity-40 z-50">
  <div class="bg-white rounded-lg p-6 w-11/12 max-w-md shadow-lg">
    <h3 class="text-lg font-bold mb-4 text-center text-indigo-700">ë©˜íŠ¸ ìˆ˜ì •</h3>
    <textarea id="editCommentText" class="w-full h-32 p-2 border rounded-md text-sm" placeholder="ìˆ˜ì •í•  ë©˜íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    <div class="flex justify-center mt-4 gap-4">
      <button onclick="saveCommentEdit()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-4 rounded-full text-sm">ì €ì¥</button>
      <button onclick="closeEditCommentModal()" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-1 px-4 rounded-full text-sm">ì·¨ì†Œ</button>
    </div>
  </div>
</div>

<!-- ì°¸ê³  ê¸°ì¤€ ëª¨ë‹¬ -->
<div id="referenceModal" class="hidden fixed inset-0 w-full h-full flex items-center justify-center bg-black bg-opacity-30 z-50">
  <div class="bg-white rounded-lg p-6 w-11/12 max-w-2xl shadow-lg">
    <h3 class="text-lg font-bold mb-6 text-center text-indigo-700">ì°¸ê³  ê¸°ì¤€í‘œ</h3>
    <div class="flex justify-center mb-6 space-x-2">
      <button onclick="showYouthStandard()" class="tab-button active-tab">5~11ì„¸</button>
      <button onclick="showPAPSStandard()" class="tab-button">12ì„¸ ì´ìƒ</button>
    </div>
    <div id="youthStandard" class="overflow-x-auto mb-4"></div>
    <div id="papsStandard" class="hidden overflow-x-auto mb-4"></div>
    <div class="text-center mt-6">
      <button onclick="closeReferenceModal()" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<!-- ì „ì²´ ê¸°ëŠ¥ ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘ -->
<script>
// ì•ˆì „í•˜ê²Œ ê°’ í‘œì‹œ
function safe(v) {
  return (v !== undefined && v !== null && v !== '') ? v : '-';
}

// URL íŒŒë¼ë¯¸í„° ì½ê¸°
function getParams() {
  const p = new URLSearchParams(window.location.search);
  return {
    name: p.get('name') || '',
    gender: p.get('gender') || '',
    birth: p.get('birth') || '',
    measureDate: p.get('measureDate') || '',
    height: p.get('height') ? parseFloat(p.get('height')) : undefined,
    weight: p.get('weight') ? parseFloat(p.get('weight')) : undefined,
    tests: [
      { label:'ìœ ì—°ì„±', t1:p.get('t01')?parseFloat(p.get('t01')):undefined, t2:p.get('t02')?parseFloat(p.get('t02')):undefined },
      { label:'ê·¼ë ¥',   t1:p.get('t11')?parseFloat(p.get('t11')):undefined, t2:p.get('t12')?parseFloat(p.get('t12')):undefined },
      { label:'ìˆœë°œë ¥', t1:p.get('t21')?parseFloat(p.get('t21')):undefined, t2:p.get('t22')?parseFloat(p.get('t22')):undefined },
      { label:'ë¯¼ì²©ì„±', t1:p.get('t31')?parseFloat(p.get('t31')):undefined, t2:p.get('t32')?parseFloat(p.get('t32')):undefined },
      { label:'í‰í˜•ì„±', t1:p.get('t41')?parseFloat(p.get('t41')):undefined, t2:p.get('t42')?parseFloat(p.get('t42')):undefined },
      { label:'í˜‘ì‘ì„±', t1:p.get('t51')?parseFloat(p.get('t51')):undefined, t2:p.get('t52')?parseFloat(p.get('t52')):undefined }
    ]
  };
}
  <!-- ì‹ ì²´ì¡°ì„± í‰ê°€ -->
<div id="body-composition" class="section-card">
  <h2 class="section-title">ì‹ ì²´ì¡°ì„± í‰ê°€</h2>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
      <table class="info-table">
        <tr><th>ì‹ ì¥ (cm)</th><td id="heightCell">-</td></tr>
        <tr><th>ì²´ì¤‘ (kg)</th><td id="weightCell">-</td></tr>
      </table>
      <div id="avgInfo" class="text-xs text-right text-gray-500 mt-1"></div>
    </div>
    <div>
      <h3 class="subsection-title">BMI í‰ê°€</h3>
      <div class="bmi-bar">
        <div class="bmi-seg bg-blue-400" style="left:0; width:25%;">ì €ì²´ì¤‘</div>
        <div class="bmi-seg bg-green-400" style="left:25%; width:20%;">ì •ìƒ</div>
        <div class="bmi-seg bg-yellow-400" style="left:45%; width:20%;">ê³¼ì²´ì¤‘</div>
        <div class="bmi-seg bg-orange-400" style="left:65%; width:35%; border-top-right-radius:9999px; border-bottom-right-radius:9999px;">ë¹„ë§Œ</div>
        <span class="threshold-label" style="left:25%;">18.5</span>
        <span class="threshold-label" style="left:45%;">23</span>
        <span class="threshold-label" style="left:65%;">25</span>
        <div id="bmiMarkerLine" class="marker-line"></div>
        <div id="bmiMarkerArrow" class="marker-arrow"></div>
        <span id="bmiMarkerValue" class="marker-value">-</span>
      </div>
    </div>
  </div>
</div>

<!-- ì²´ë ¥ ì¸¡ì • ì¢…í•© -->
<div id="fitness-summary" class="section-card">
  <h2 class="section-title">ì²´ë ¥ ì¸¡ì • ì¢…í•©</h2>
  <canvas id="radarChart" width="300" height="300" class="mx-auto"></canvas>
</div>

<!-- í•­ëª©ë³„ ì„¸ë¶€ í‰ê°€ -->
<div id="detailed-assessment" class="section-card">
  <h2 class="section-title">í•­ëª©ë³„ ì„¸ë¶€ í‰ê°€</h2>
  <div id="detailCards" class="space-y-4"></div>
</div>

<!-- ë²„íŠ¼ ì˜ì—­ -->
<div class="flex justify-center flex-wrap gap-4 my-8">
  <button onclick="openReferenceModal()" class="tab-button">ì°¸ê³  ê¸°ì¤€ ë³´ê¸°</button>
  <button onclick="downloadPDF()" class="tab-button">PDF ì €ì¥í•˜ê¸°</button>
</div>

<!-- ìƒë‹´ë¬¸ì˜ -->
<div class="text-center text-sm text-gray-600 mt-10">
  ìƒë‹´ë¬¸ì˜ : 010-5380-5840<br>
  <a href="https://linktr.ee/Kokenigym" target="_blank" class="text-blue-600 underline">ì½”í¬ë‹ˆì§ Linktree ë°”ë¡œê°€ê¸°</a>
</div>

<!-- ëª¨ë‹¬ - ì¸¡ì • ë°©ë²• -->
<div id="methodModal" class="modal hidden">
  <div class="modal-content">
    <h3 id="methodTitle" class="modal-title"></h3>
    <p id="methodDesc" class="modal-desc"></p>
    <div class="text-center mt-4">
      <button onclick="closeMethodModal()" class="btn-secondary">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<!-- ëª¨ë‹¬ - ì°¸ê³  ê¸°ì¤€ -->
<div id="referenceModal" class="modal hidden">
  <div class="modal-content max-w-3xl">
    <h3 class="modal-title">ì°¸ê³  ê¸°ì¤€í‘œ</h3>
    <div class="tab-container">
      <button onclick="showYouthStandard()" id="btnYouthStandard" class="tab-button active-tab">5~11ì„¸</button>
      <button onclick="showPAPSStandard()" id="btnPAPSStandard" class="tab-button">12ì„¸ ì´ìƒ</button>
    </div>
    <div id="youthStandard" class="overflow-x-auto mt-4"></div>
    <div id="papsStandard" class="overflow-x-auto hidden mt-4"></div>
    <div class="text-center mt-6">
      <button onclick="closeReferenceModal()" class="btn-secondary">ë‹«ê¸°</button>
    </div>
  </div>
</div>
  <script>
// ì•ˆì „í•˜ê²Œ ê°’ í‘œì‹œ
function safe(v) {
  return (v !== undefined && v !== null && v !== '') ? v : '-';
}

// URL íŒŒë¼ë¯¸í„° ì½ê¸°
function getParams() {
  const p = new URLSearchParams(window.location.search);
  return {
    name: p.get('name') || '',
    gender: p.get('gender') || '',
    birth: p.get('birth') || '',
    measureDate: p.get('measureDate') || '',
    height: p.get('height') ? parseFloat(p.get('height')) : undefined,
    weight: p.get('weight') ? parseFloat(p.get('weight')) : undefined,
    tests: [
      { label: 'ìœ ì—°ì„±', t1: p.get('t01') ? parseFloat(p.get('t01')) : undefined, t2: p.get('t02') ? parseFloat(p.get('t02')) : undefined },
      { label: 'ê·¼ë ¥', t1: p.get('t11') ? parseFloat(p.get('t11')) : undefined, t2: p.get('t12') ? parseFloat(p.get('t12')) : undefined },
      { label: 'ìˆœë°œë ¥', t1: p.get('t21') ? parseFloat(p.get('t21')) : undefined, t2: p.get('t22') ? parseFloat(p.get('t22')) : undefined },
      { label: 'ë¯¼ì²©ì„±', t1: p.get('t31') ? parseFloat(p.get('t31')) : undefined, t2: p.get('t32') ? parseFloat(p.get('t32')) : undefined },
      { label: 'í‰í˜•ì„±', t1: p.get('t41') ? parseFloat(p.get('t41')) : undefined, t2: p.get('t42') ? parseFloat(p.get('t42')) : undefined },
      { label: 'í˜‘ì‘ì„±', t1: p.get('t51') ? parseFloat(p.get('t51')) : undefined, t2: p.get('t52') ? parseFloat(p.get('t52')) : undefined }
    ]
  };
}

// ë‚˜ì´ ê³„ì‚°
function calculateAge(birth, measure) {
  if (!birth || !measure) return '';
  const bd = new Date(birth);
  const md = new Date(measure);
  let age = md.getFullYear() - bd.getFullYear();
  const m = md.getMonth() - bd.getMonth();
  if (m < 0 || (m === 0 && md.getDate() < bd.getDate())) age--;
  return age;
}

// BMI ì¢Œí‘œ ê³„ì‚°
function bmiToPosition(bmi) {
  if (bmi < 18.5) return (bmi / 18.5) * 25;
  if (bmi < 23) return 25 + (bmi - 18.5) / 4.5 * 20;
  if (bmi < 25) return 45 + (bmi - 23) / 2 * 20;
  return 65 + (bmi - 25) / 5 * 35;
}

// ì—°ë ¹ë³„ í‰ê·  ì‹ ì¥/ì²´ì¤‘ ë°ì´í„°
const averageData = {
  '5': { height: 110, weight: 18 },
  '6': { height: 116, weight: 20 },
  '7': { height: 122, weight: 22 },
  '8': { height: 128, weight: 25 },
  '9': { height: 133, weight: 28 },
  '10': { height: 138, weight: 31 },
  '11': { height: 143, weight: 34 },
  '12': { height: 150, weight: 40 },
  '13': { height: 156, weight: 45 },
  '14': { height: 162, weight: 50 },
  '15': { height: 168, weight: 56 },
  '16': { height: 172, weight: 61 },
  '17': { height: 175, weight: 65 },
  '18': { height: 177, weight: 68 }
};

// ê¸°ë³¸ ì •ë³´ ì„¸íŒ…
function setupBasicInfo(data) {
  document.getElementById('nameCell').innerText = safe(data.name);
  document.getElementById('genderCell').innerText = safe(data.gender);
  document.getElementById('birthCell').innerText = safe(data.birth) + (data.birth && data.measureDate ? ` (ë§Œ ${calculateAge(data.birth, data.measureDate)}ì„¸)` : '');
  document.getElementById('measureDateCell').innerText = safe(data.measureDate);
  document.getElementById('heightCell').innerText = safe(data.height);
  document.getElementById('weightCell').innerText = safe(data.weight);

  // BMI ë§ˆì»¤ í‘œì‹œ
  if (data.height && data.weight) {
    const bmi = (data.weight / ((data.height / 100) ** 2)).toFixed(1);
    const mk = bmiToPosition(parseFloat(bmi));
    document.getElementById('bmiMarkerLine').style.left = mk + '%';
    document.getElementById('bmiMarkerArrow').style.left = mk + '%';
    document.getElementById('bmiMarkerValue').style.left = mk + '%';
    document.getElementById('bmiMarkerValue').innerText = bmi;
  }

  // ì—°ë ¹ë³„ í‰ê·  í‘œì‹œ
  if (data.birth && data.measureDate) {
    const age = calculateAge(data.birth, data.measureDate);
    if (averageData[age]) {
      document.getElementById('avgInfo').innerHTML = `ëŒ€í•œë¯¼êµ­ ${age}ì„¸ ë‚¨ì•„ í‰ê·  ì‹ ì¥ ${averageData[age].height}cm / í‰ê·  ì²´ì¤‘ ${averageData[age].weight}kg`;
    } else {
      document.getElementById('avgInfo').innerHTML = `í•´ë‹¹ ì—°ë ¹ì€ í‰ê·  ë°ì´í„°ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`;
    }
  }
}
</script>
<script>
// ë ˆì´ë” ì°¨íŠ¸ ê·¸ë¦¬ê¸°
function drawRadarChart(tests) {
  const ctx = document.getElementById('radarChart').getContext('2d');
  new Chart(ctx, {
    type: 'radar',
    data: {
      labels: tests.map(t => t.label),
      datasets: [
        {
          label: '1íšŒ ì¸¡ì •',
          data: tests.map(t => t.t1 || 0),
          fill: true,
          backgroundColor: 'rgba(59,130,246,0.2)',
          borderColor: 'rgba(59,130,246,1)'
        },
        {
          label: '2íšŒ ì¸¡ì •',
          data: tests.map(t => t.t2 || 0),
          fill: true,
          backgroundColor: 'rgba(16,185,129,0.2)',
          borderColor: 'rgba(16,185,129,1)'
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { position: 'top' } },
      scales: { r: { suggestedMin: 0, suggestedMax: 100 } }
    }
  });
}

// ë“±ê¸‰ë³„ ë©˜íŠ¸ ë°ì´í„°
const gradeComments = {
  ìœ ì—°ì„±: [
    "ë§¤ìš° í›Œë¥­í•œ ìœ ì—°ì„±ì„ ê°€ì§€ê³  ìˆì–´ìš”! ê³„ì† ìŠ¤íŠ¸ë ˆì¹­ ìŠµê´€ì„ ìœ ì§€í•˜ì„¸ìš”.",
    "ì¢‹ì€ ìœ ì—°ì„±ì…ë‹ˆë‹¤. ì¡°ê¸ˆ ë” ê¾¸ì¤€íˆ ê´€ë¦¬í•˜ë©´ ê¸ˆë°© ìµœê³  ìˆ˜ì¤€ì— ë„ë‹¬í•  ìˆ˜ ìˆì–´ìš”!",
    "ê¸°ë³¸ì ì¸ ìœ ì—°ì„±ì€ ê°–ì¶”ì—ˆì–´ìš”. ìŠ¤íŠ¸ë ˆì¹­ ì‹œê°„ì„ ëŠ˜ë ¤ë³¼ê¹Œìš”?",
    "ì•„ì§ ìœ ì—°ì„±ì´ ë¶€ì¡±í•´ìš”. í•˜ë£¨ 5ë¶„ì”© ê¾¸ì¤€íˆ ì—°ìŠµí•˜ë©´ ì¢‹ì•„ì§ˆ ê±°ì˜ˆìš”!"
  ],
  ê·¼ë ¥: [
    "ê·¼ë ¥ì´ ë§¤ìš° íƒ„íƒ„í•©ë‹ˆë‹¤! ê¾¸ì¤€í•œ ìš´ë™ ìŠµê´€ì´ ëŠê»´ì ¸ìš”.",
    "ê·¼ë ¥ì´ ì¢‹ì€ í¸ì´ì—ìš”. í˜„ì¬ ìš´ë™ì„ ê¾¸ì¤€íˆ ì´ì–´ê°€ì„¸ìš”!",
    "í‰ê· ì ì¸ ê·¼ë ¥ì…ë‹ˆë‹¤. ì¡°ê¸ˆ ë” ê·¼ì§€êµ¬ë ¥ ìš´ë™ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.",
    "ê·¼ë ¥ í–¥ìƒì´ í•„ìš”í•©ë‹ˆë‹¤. ê²Œì„ì²˜ëŸ¼ ì¬ë¯¸ìˆê²Œ ìš´ë™ì„ ì‹œì‘í•´ë³¼ê¹Œìš”?"
  ],
  ìˆœë°œë ¥: [
    "ìˆœë°œë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤! í­ë°œì ì¸ í˜ì„ ì˜ í™œìš©í•˜ì„¸ìš”.",
    "ìˆœë°œë ¥ ì¢‹ì€ í¸ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ ì í”„ ë†€ì´ë¥¼ ì¶”ì²œí•´ìš”!",
    "ìˆœë°œë ¥ì€ í‰ê·  ì •ë„ì˜ˆìš”. ì í”„ í›ˆë ¨ì„ í•´ë³´ë©´ ê¸ˆë°© í–¥ìƒë  ìˆ˜ ìˆì–´ìš”.",
    "ìˆœë°œë ¥ì´ ì•½í•œ í¸ì…ë‹ˆë‹¤. ì§§ì€ ê±°ë¦¬ ë›°ê¸° ë†€ì´ë¥¼ ìì£¼ í•´ë´ìš”!"
  ],
  ë¯¼ì²©ì„±: [
    "ë¯¼ì²©ì„±ì´ ì•„ì£¼ ë›°ì–´ë‚©ë‹ˆë‹¤! ë°©í–¥ ì „í™˜ì´ ë¹ ë¥´ë„¤ìš”!",
    "ë¯¼ì²©ì„±ì´ ì¢‹ì•„ìš”. ë¯¼ì²©ì„± ê²Œì„ì„ í•¨ê»˜ ì¶”ê°€í•´ë³´ì„¸ìš”!",
    "ë¯¼ì²©ì„±ì€ í‰ê· ì´ì—ìš”. ë‹¤ì–‘í•œ ë¦¬ë“¬ìš´ë™ì„ ì¶”ì²œí•©ë‹ˆë‹¤.",
    "ë¯¼ì²©ì„±ì´ ì•„ì§ ë¶€ì¡±í•´ìš”. ì¦ê²ê²Œ ë‹¬ë¦¬ê¸° ë†€ì´ë¥¼ ìì£¼ í•´ë´ìš”!"
  ],
  í‰í˜•ì„±: [
    "í‰í˜•ê°ê°ì´ ë§¤ìš° í›Œë¥­í•©ë‹ˆë‹¤! ëª¸ì˜ ê· í˜•ì´ ì¢‹ì•„ìš”.",
    "ì¢‹ì€ í‰í˜•ì„±ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ ìì„¸ë¡œ ê· í˜• ì—°ìŠµì„ í•´ë³´ì„¸ìš”!",
    "í‰í˜•ì„±ì€ í‰ê·  ìˆ˜ì¤€ì…ë‹ˆë‹¤. ê°„ë‹¨í•œ ìš”ê°€ ë™ì‘ë„ ë„ì›€ì´ ë¼ìš”.",
    "í‰í˜•ì„±ì´ ì•½í•œ í¸ì…ë‹ˆë‹¤. í•œë°œì„œê¸° ê²Œì„ì„ ë§¤ì¼ í•´ë³´ì„¸ìš”!"
  ],
  í˜‘ì‘ì„±: [
    "í˜‘ì‘ë ¥ì´ ì•„ì£¼ ë›°ì–´ë‚©ë‹ˆë‹¤! ëª¸ê³¼ ì†ì˜ ì¡°í™”ê°€ ë©‹ì ¸ìš”.",
    "í˜‘ì‘ì„± ì¢‹ì€ í¸ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ ê³µë†€ì´ë¥¼ ë” ì‹œë„í•´ë³´ì„¸ìš”!",
    "í˜‘ì‘ì„±ì€ í‰ê·  ìˆ˜ì¤€ì…ë‹ˆë‹¤. íŒ¨í„´ ê²Œì„ì„ ì¶”ì²œí•´ìš”.",
    "í˜‘ì‘ë ¥ì´ ì•„ì§ ë¶€ì¡±í•´ìš”. ì¬ë¯¸ìˆëŠ” ìºì¹˜ ë†€ì´ë¡œ í‚¤ì›Œë´ìš”!"
  ]
};

// ì¸¡ì •ë°©ë²• ì„¤ëª…
const methods = [
  { title: 'ì¢Œì „êµ´ (Sit and Reach Test)', desc: 'ì•‰ì€ ìì„¸ì—ì„œ ìƒì²´ë¥¼ ì•ìœ¼ë¡œ êµ½í˜€ ì†ëì´ ë‹¿ëŠ” ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ì—¬ ìœ ì—°ì„±ì„ í‰ê°€í•©ë‹ˆë‹¤.' },
  { title: 'ìœ—ëª¸ ì¼ìœ¼í‚¤ê¸° (Sit-up Test)', desc: '1ë¶„ ë™ì•ˆ ê°€ëŠ¥í•œ ë§ì€ ìœ—ëª¸ ì¼ìœ¼í‚¤ê¸°ë¥¼ í•˜ì—¬ ê·¼ë ¥ì„ í‰ê°€í•©ë‹ˆë‹¤.' },
  { title: 'ì œìë¦¬ë©€ë¦¬ë›°ê¸° (Standing Long Jump)', desc: 'ì œìë¦¬ì—ì„œ ë‘ ë°œë¡œ ë©€ë¦¬ ë›°ì–´ ìˆœë°œë ¥ì„ í‰ê°€í•©ë‹ˆë‹¤.' },
  { title: 'ì¥ì• ë¬¼ ì™•ë³µë‹¬ë¦¬ê¸° (Shuttle Run)', desc: 'ì§§ì€ ê±°ë¦¬ êµ¬ê°„ì„ ë°˜ë³µí•˜ì—¬ ë‹¬ë¦¬ëŠ” ì‹œê°„ì„ ì¸¡ì •í•˜ì—¬ ë¯¼ì²©ì„±ì„ í‰ê°€í•©ë‹ˆë‹¤.' },
  { title: 'í•œë°œì„œê¸° (One-leg Stand)', desc: 'í•œ ë°œë¡œ ë²„í‹°ëŠ” ì‹œê°„ì„ ì¸¡ì •í•˜ì—¬ í‰í˜•ì„±ì„ í‰ê°€í•©ë‹ˆë‹¤.' },
  { title: 'ê³µì¡ê¸° (Ball Catching)', desc: 'ì œí•œëœ ì‹œê°„ ë™ì•ˆ ê³µì„ ì¡ëŠ” íšŸìˆ˜ë¡œ í˜‘ì‘ì„±ì„ í‰ê°€í•©ë‹ˆë‹¤.' }
];

// ë“±ê¸‰ ê³„ì‚°
function getGrade(score, cat) {
  if (cat === 'ë¯¼ì²©ì„±') {
    if (score <= 4.5) return 0;
    if (score <= 5.5) return 1;
    if (score <= 6.5) return 2;
    return 3;
  }
  if (cat === 'í˜‘ì‘ì„±') {
    if (score >= 3) return 0;
    if (score >= 2) return 1;
    if (score >= 1) return 2;
    return 3;
  }
  if (cat === 'ìˆœë°œë ¥') {
    if (score >= 140) return 0;
    if (score >= 120) return 1;
    if (score >= 100) return 2;
    return 3;
  }
  if (cat === 'ê·¼ë ¥') {
    if (score >= 60) return 0;
    if (score >= 40) return 1;
    if (score >= 20) return 2;
    return 3;
  }
  if (cat === 'ìœ ì—°ì„±') {
    if (score >= 13) return 0;
    if (score >= 10) return 1;
    if (score >= 5) return 2;
    return 3;
  }
  if (cat === 'í‰í˜•ì„±') {
    if (score >= 60) return 0;
    if (score >= 40) return 1;
    if (score >= 20) return 2;
    return 3;
  }
  return 3;
}
</script>
<script>
// ì„¸ë¶€ ì¹´ë“œ ìƒì„±
function createDetailCards(tests) {
  const container = document.getElementById('detailCards');
  container.innerHTML = '';

  tests.forEach((t, i) => {
    const method = methods[i];
    const label = t.label;
    const grade = (t.t1 !== undefined) ? getGrade(t.t1, label) : 3;
    const comment = gradeComments[label][grade];

    const card = document.createElement('div');
    card.className = 'glass-card';

    card.innerHTML = `
      <div class="flex justify-between items-center">
        <h2 class="text-md font-bold text-indigo-700">${label}</h2>
        <div class="text-right">
          <span class="text-xs text-gray-600">${['ìš°ìˆ˜', 'ì–‘í˜¸', 'ë³´í†µ', 'ë¯¸í¡'][grade]} (${grade + 1}ë“±ê¸‰)</span>
        </div>
      </div>
      <div class="mt-2 flex items-center space-x-2">
        <div class="flex-1 bg-gray-200 rounded-full h-2 relative">
          <div class="bg-blue-400 h-2 rounded-full" style="width: ${Math.min((t.t1 || 0), 100)}%;"></div>
          <div class="absolute top-[-20px] left-[calc(${Math.min((t.t1 || 0), 100)}%-10px)] text-xs">${safe(t.t1)}</div>
        </div>
      </div>
      <table class="w-full text-xs mt-4">
        <tbody>
          <tr>
            <th class="text-left w-1/3">ì¸¡ì • ë°©ë²•</th>
            <td>
              <button onclick="openMethodModal('${method.title}','${method.desc}')" class="text-blue-600 underline">${method.title}</button>
            </td>
          </tr>
          <tr><th class="text-left">1íšŒ ì¸¡ì •ê°’</th><td>${safe(t.t1)}</td></tr>
          <tr><th class="text-left">2íšŒ ì¸¡ì •ê°’</th><td>${safe(t.t2)}</td></tr>
        </tbody>
      </table>
      <p class="text-xs text-gray-700 mt-2 leading-relaxed cursor-pointer" onclick="editComment(this)">${comment}</p>
    `;
    container.appendChild(card);
  });
}

// ì¸¡ì •ë°©ë²• íŒì—…
function openMethodModal(title, desc) {
  document.getElementById('methodTitle').innerText = title;
  document.getElementById('methodDesc').innerText = desc;
  document.getElementById('methodModal').classList.remove('hidden');
}
function closeMethodModal() {
  document.getElementById('methodModal').classList.add('hidden');
}

// ì½”ë©˜íŠ¸ ìˆ˜ì •
function editComment(pElement) {
  const currentComment = pElement.innerText;
  const newComment = prompt('ìˆ˜ì •í•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”:', currentComment);
  if (newComment !== null && newComment.trim() !== '') {
    pElement.innerText = newComment;
  }
}

// ì°¸ê³  ê¸°ì¤€ ëª¨ë‹¬ ì œì–´
function openReferenceModal() {
  document.getElementById('referenceModal').classList.remove('hidden');
}
function closeReferenceModal() {
  document.getElementById('referenceModal').classList.add('hidden');
}
function showYouthStandard() {
  document.getElementById('youthStandard').classList.remove('hidden');
  document.getElementById('papsStandard').classList.add('hidden');
}
function showPAPSStandard() {
  document.getElementById('papsStandard').classList.remove('hidden');
  document.getElementById('youthStandard').classList.add('hidden');
}

// PDF ì €ì¥
function downloadPDF() {
  html2pdf().from(document.body).set({
    margin: 0.5,
    filename: 'Result.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
  }).save();
}

// ëª¨ë°”ì¼/PC ë ˆì´ì•„ì›ƒ ì „í™˜
function switchLayout(mode) {
  const root = document.documentElement;
  if (mode === 'mobile') {
    root.style.setProperty('--max-width', '480px');
    root.style.setProperty('--padding', '1rem');
  } else {
    root.style.setProperty('--max-width', '800px');
    root.style.setProperty('--padding', '2rem');
  }
}

// DOMContentLoaded
document.addEventListener('DOMContentLoaded', () => {
  const data = getParams();

  if (data.name) {
    setupBasicInfo(data);
    createDetailCards(data.tests);
    drawRadarChart(data.tests);
  } else {
    // ë¹ˆê°’ ì²˜ë¦¬
    setupBasicInfo({ name: '', gender: '', birth: '', measureDate: '', height: '', weight: '' });
    createDetailCards([
      { label: 'ìœ ì—°ì„±', t1: 0, t2: 0 },
      { label: 'ê·¼ë ¥', t1: 0, t2: 0 },
      { label: 'ìˆœë°œë ¥', t1: 0, t2: 0 },
      { label: 'ë¯¼ì²©ì„±', t1: 0, t2: 0 },
      { label: 'í‰í˜•ì„±', t1: 0, t2: 0 },
      { label: 'í˜‘ì‘ì„±', t1: 0, t2: 0 }
    ]);
    drawRadarChart([
      { label: 'ìœ ì—°ì„±', t1: 0, t2: 0 },
      { label: 'ê·¼ë ¥', t1: 0, t2: 0 },
      { label: 'ìˆœë°œë ¥', t1: 0, t2: 0 },
      { label: 'ë¯¼ì²©ì„±', t1: 0, t2: 0 },
      { label: 'í‰í˜•ì„±', t1: 0, t2: 0 },
      { label: 'í˜‘ì‘ì„±', t1: 0, t2: 0 }
    ]);
  }

  // ê¸°ë³¸ê°’ ëª¨ë°”ì¼ë¡œ
  switchLayout('mobile');
});
</script>
<!-- ëª¨ë°”ì¼/PC ë ˆì´ì•„ì›ƒ í† ê¸€ ë²„íŠ¼ -->
<div class="fixed top-4 right-4 flex space-x-2 z-50">
  <button onclick="switchLayout('mobile')" class="bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-sm shadow">ëª¨ë°”ì¼ ë³´ê¸°</button>
  <button onclick="switchLayout('desktop')" class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-sm shadow">PC ë³´ê¸°</button>
</div>

<style>
  /* ë ˆì´ì•„ì›ƒ ë°˜ì‘í˜• ì„¤ì • */
  :root {
    --max-width: 480px;
    --padding: 1rem;
  }

  body {
    max-width: var(--max-width);
    margin: auto;
    padding: var(--padding);
    background: #E0F2FE;
    font-family: 'Pretendard', sans-serif;
  }

  .glass-card {
    background: rgba(255,255,255,0.6);
    backdrop-filter: blur(12px);
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    border: 1px solid rgba(255,255,255,0.5);
    border-radius: 1rem;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .title-gradient {
    background: linear-gradient(90deg, #3b82f6, #10b981);
    -webkit-background-clip: text;
    color: transparent;
    font-weight: 800;
    font-size: 1.875rem;
    text-align: center;
    margin-bottom: 2rem;
  }

  .score-bar {
    position: relative;
    width: 100%;
    height: 2rem;
    background: #f3f4f6;
    border-radius: 9999px;
    overflow: visible;
    margin-top: 1.5rem;
  }

  .score-seg {
    position: absolute;
    top: 0;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.625rem;
    font-weight: 500;
    color: white;
  }

  .threshold-label {
    position: absolute;
    top: -1.5rem;
    font-size: 0.75rem;
    font-weight: 600;
    color: #9ca3af;
    transform: translateX(-50%);
  }

  .marker-line {
    position: absolute;
    bottom: 0;
    height: 100%;
    width: 2px;
    background: #1f1f1f;
    transform: translateX(-50%);
  }

  .marker-arrow {
    position: absolute;
    bottom: -0.5rem;
    width: 0;
    height: 0;
    border-left: 5px solid transparent;
    border-right: 5px solid transparent;
    border-top: 7px solid #1f1f1f;
    transform: translateX(-50%);
  }

  .marker-value {
    position: absolute;
    bottom: -2rem;
    font-size: 0.875rem;
    font-weight: 700;
    transform: translateX(-50%);
    color: #1f1f1f;
  }

  /* ì¸¡ì • ë°©ë²• ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
  #methodModal,
  #referenceModal {
    backdrop-filter: blur(4px);
  }
</style>

</body>
</html>
